<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GP Site Solutions â€” Employee Hub Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#66B245" />
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32.png" />
  <link rel="icon" href="favicon.ico" />
  <link rel="apple-touch-icon" href="icon-192.png" />
  <link rel="manifest" href="manifest.json" />
  <style>
    :root{
      --gp-green:#66B245;
      --gp-dark:#0A0A0A;
      color-scheme: light dark;
    }
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      margin:0; padding:24px; text-align:center;
      background: Canvas; color: CanvasText;
    }
    .wrap{
      max-width: 560px; margin: 8vh auto; padding: 28px 28px 22px;
      border-radius: 18px; box-shadow: 0 8px 30px rgba(0,0,0,.08);
      background: Field; color: FieldText;
    }
    img.logo{ height:64px; margin-bottom: 8px; }
    h1{ font-size:22px; margin: 6px 0 4px; font-weight:700; }
    input{
      padding:16px; margin:10px 0; width:100%; font-size:18px;
      border-radius:12px; border:1px solid #d0d7de; outline:none;
    }
    button{
      padding:14px 20px; font-size:18px; cursor:pointer; width:100%;
      border:none; border-radius:12px; font-weight:600;
      background:linear-gradient(180deg,#66B245,#4E8E36); color:#fff;
    }
    #message{ margin-top:12px; min-height:22px; font-size:15px; }
  </style>
</head>
<body>
  <div class="wrap">
    <img class="logo" src="logo.png" alt="GP Site Solutions logo" />
    <h1>GP Site Solutions â€” Employee Hub Login</h1>
    <form id="login-form">
      <input type="email" id="email" placeholder="Enter your work email" required />
      <button type="submit">Continue</button>
    </form>
    <p id="message"></p>
    <noscript style="color:red; font-size:14px;">
      JavaScript is disabled in your browser. Please enable it to access the Employee Hub.
    </noscript>
  </div>

  <script>
    // âœ… List of allowed users
    const users = [
      { id: 1,  email: "leonardgreeff@glosscalm.com" },
      { id: 2,  email: "hbennett@greenpower-plant.co.uk" },
      { id: 3,  email: "will@greenpower-plant.co.uk" },
      { id: 4,  email: "eva.rawlins@duntonplant.co.uk" },
      { id: 5,  email: "ajames@greenpower-plant.co.uk" },
      { id: 6,  email: "dgrove@greenpower-plant.co.uk" },
      { id: 7,  email: "lswingle@greenpower-plant.co.uk" },
      { id: 8,  email: "mparkes@greenpower-plant.co.uk" },
      { id: 9,  email: "smoss@greenpower-plant.co.uk" },
      { id: 10, email: "tanson@greenpower-plant.co.uk" },
      { id: 11, email: "erawlins@greenpower-plant.co.uk" }
    ];

    // ðŸ”— Put your real Apps Script URL here if you want logging
    const APPS_SCRIPT_URL = ""; // leave empty for now to avoid errors

    function logEmailToSheet(email){
      if (!APPS_SCRIPT_URL) return; // safely do nothing if not configured

      fetch(APPS_SCRIPT_URL, {
        method: "POST",
        body: JSON.stringify({ email }),
        headers: { "Content-Type": "application/json" },
        mode: "no-cors"
      });
    }

    function checkUser(email, msgEl){
      const normalisedEmail = email.trim().toLowerCase();

      // Debug: show what the browser sees
      console.log("Entered email:", normalisedEmail);

      const user = users.find(u => u.email.toLowerCase() === normalisedEmail);

      if (user) {
        msgEl.textContent = "Access granted. Redirectingâ€¦";
        logEmailToSheet(normalisedEmail);

        setTimeout(() => {
          window.location.href = "https://sites.google.com/view/gp-site-solutions-employee-hub/home";
        }, 800);
      } else {
        msgEl.textContent = "Email not found. Please use your approved work email.";
      }
    }

    // âœ… Attach the submit handler once the DOM is ready
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById("login-form");
      const emailInput = document.getElementById("email");
      const msg = document.getElementById("message");

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        msg.textContent = ""; // clear old message
        checkUser(emailInput.value, msg);
      });
    });
  </script>
</body>
</html>
